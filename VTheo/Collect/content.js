chrome.runtime.onMessage.addListener( function(request, sender, sendResponse){
       //localStorage["pages"] = request.pages;
       //console.log(localStorage["pages"])
       
       if(request.text === 'report_back'){
        //ytplayer = document.getElementById("movie_player");
        
        //console.log(document.getElementsByTagName('video')[0])
        //sendResponse(document.PlayerState)
        //sendResponse(document.all[0].outerHTML);
        console.log('coucou')
        document.getElementsByClassName("video-stream")[0].pause();
        console.log(document.getElementsByClassName("video-stream")[0].currentTime);
        sendResponse(document.getElementsByClassName("video-stream")[0].currentTime);
       }
    }
);

var svgString = 
'<svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="48" height="48" rx="24" fill="white"/><path fill-rule="evenodd" clip-rule="evenodd" d="M25.8849 47.9271C25.2629 47.9754 24.6343 48 24 48C23.3657 48 22.7371 47.9754 22.1151 47.9271L22.3617 44.753C22.9017 44.7949 23.448 44.8163 24 44.8163C24.552 44.8163 25.0983 44.7949 25.6383 44.753L25.8849 47.9271ZM18.3949 47.3419L19.1357 44.2457C18.0669 43.9899 17.0302 43.6517 16.0326 43.238L14.8131 46.1789C15.9645 46.6564 17.1612 47.0468 18.3949 47.3419ZM11.4586 44.4665L13.1246 41.7535C12.193 41.1814 11.3095 40.5378 10.4818 39.8303L8.41307 42.2502C9.36652 43.0653 10.3846 43.8069 11.4586 44.4665ZM5.74981 39.5869L8.16974 37.5182C7.46215 36.6905 6.81857 35.807 6.24651 34.8754L3.53354 36.5414C4.19305 37.6154 4.93473 38.6335 5.74981 39.5869ZM1.82113 33.1869L4.76198 31.9674C4.34827 30.9698 4.01005 29.9331 3.75434 28.8643L0.658055 29.6051C0.953218 30.8388 1.34365 32.0355 1.82113 33.1869ZM0.0729274 25.8849L3.24704 25.6383C3.20509 25.0983 3.18367 24.552 3.18367 24C3.18367 23.448 3.20509 22.9017 3.24704 22.3617L0.0729273 22.1151C0.02461 22.7371 0 23.3657 0 24C0 24.6343 0.02461 25.2629 0.0729274 25.8849ZM0.658054 18.3949L3.75434 19.1357C4.01005 18.0669 4.34827 17.0302 4.76197 16.0326L1.82113 14.8131C1.34365 15.9645 0.953218 17.1612 0.658054 18.3949ZM3.53354 11.4586L6.24651 13.1246C6.81857 12.193 7.46215 11.3095 8.16974 10.4818L5.74981 8.41307C4.93473 9.36652 4.19305 10.3846 3.53354 11.4586ZM8.41307 5.74981L10.4818 8.16974C11.3095 7.46215 12.193 6.81857 13.1246 6.24651L11.4586 3.53354C10.3846 4.19305 9.36652 4.93473 8.41307 5.74981ZM14.8131 1.82113L16.0326 4.76198C17.0302 4.34827 18.0669 4.01005 19.1357 3.75434L18.3949 0.658054C17.1612 0.953218 15.9645 1.34365 14.8131 1.82113ZM22.1151 0.0729274C22.7371 0.02461 23.3657 0 24 0C24.6343 0 25.2629 0.02461 25.8849 0.0729273L25.6383 3.24704C25.0983 3.20509 24.552 3.18367 24 3.18367C23.448 3.18367 22.9017 3.20509 22.3617 3.24704L22.1151 0.0729274ZM29.6051 0.658055L28.8643 3.75434C29.9331 4.01005 30.9698 4.34827 31.9674 4.76197L33.1869 1.82113C32.0355 1.34365 30.8388 0.953218 29.6051 0.658055ZM36.5414 3.53354L34.8754 6.24651C35.807 6.81857 36.6905 7.46215 37.5182 8.16974L39.5869 5.74981C38.6335 4.93473 37.6154 4.19305 36.5414 3.53354ZM42.2502 8.41307L39.8303 10.4818C40.5378 11.3095 41.1814 12.193 41.7535 13.1246L44.4665 11.4586C43.8069 10.3846 43.0653 9.36652 42.2502 8.41307ZM46.1789 14.8131L43.238 16.0326C43.6517 17.0302 43.9899 18.0669 44.2457 19.1357L47.3419 18.3949C47.0468 17.1612 46.6564 15.9645 46.1789 14.8131ZM47.9271 22.1151L44.753 22.3617C44.7949 22.9017 44.8163 23.448 44.8163 24C44.8163 24.552 44.7949 25.0983 44.753 25.6383L47.9271 25.8849C47.9754 25.2629 48 24.6343 48 24C48 23.3657 47.9754 22.7371 47.9271 22.1151ZM47.3419 29.6051L44.2457 28.8643C43.9899 29.9331 43.6517 30.9698 43.238 31.9674L46.1789 33.1869C46.6564 32.0355 47.0468 30.8388 47.3419 29.6051ZM44.4665 36.5414L41.7535 34.8754C41.1814 35.807 40.5378 36.6905 39.8303 37.5182L42.2502 39.5869C43.0653 38.6335 43.8069 37.6154 44.4665 36.5414ZM39.5869 42.2502L37.5182 39.8303C36.6905 40.5378 35.807 41.1814 34.8754 41.7535L36.5414 44.4665C37.6154 43.8069 38.6335 43.0653 39.5869 42.2502ZM33.1869 46.1789L31.9674 43.238C30.9698 43.6517 29.9331 43.9899 28.8643 44.2457L29.6051 47.3419C30.8388 47.0468 32.0355 46.6564 33.1869 46.1789Z" fill="black"/><path fill-rule="evenodd" clip-rule="evenodd" d="M33.6 46.003C30.6602 47.2875 27.4133 48 24 48C20.5867 48 17.3398 47.2875 14.4 46.003L15.6747 43.0856C18.2201 44.1978 21.0336 44.8163 24 44.8163C26.9664 44.8163 29.7799 44.1978 32.3253 43.0856L33.6 46.003ZM1.997 33.6L4.91437 32.3253C3.80223 29.7799 3.18367 26.9664 3.18367 24C3.18367 21.0336 3.80223 18.2201 4.91437 15.6747L1.997 14.4C0.712544 17.3398 0 20.5867 0 24C0 27.4133 0.712545 30.6602 1.997 33.6ZM14.4 1.997C17.3398 0.712545 20.5867 0 24 0C27.4133 0 30.6602 0.712544 33.6 1.997L32.3253 4.91437C29.7799 3.80223 26.9664 3.18367 24 3.18367C21.0336 3.18367 18.2201 3.80223 15.6747 4.91437L14.4 1.997ZM46.003 14.4L43.0856 15.6747C44.1978 18.2201 44.8163 21.0336 44.8163 24C44.8163 26.9664 44.1978 29.7799 43.0856 32.3253L46.003 33.6C47.2875 30.6602 48 27.4133 48 24C48 20.5867 47.2875 17.3398 46.003 14.4Z" fill="#0094FF"/><rect x="14.25" y="15" width="8.25" height="8.25" rx="2" fill="#0094FF"/><circle cx="29.25" cy="29.625" r="4.5" fill="#00D33B"/><path d="M33.579 18.4062C34.1135 18.712 34.1165 19.4818 33.5843 19.7918L27.5602 23.3006C27.028 23.6106 26.3599 23.2282 26.3575 22.6124L26.3309 15.6409C26.3285 15.0251 26.9937 14.6376 27.5282 14.9435L33.579 18.4062Z" fill="#AA04D3"/><path d="M17.6142 25.5916C17.8536 24.8546 18.8964 24.8546 19.1358 25.5916L19.7109 27.3613C19.818 27.691 20.1251 27.9141 20.4717 27.9141H22.3325C23.1075 27.9141 23.4297 28.9058 22.8027 29.3613L21.2973 30.4551C21.0169 30.6588 20.8996 31.0199 21.0067 31.3495L21.5817 33.1192C21.8212 33.8563 20.9776 34.4692 20.3506 34.0137L18.8452 32.9199C18.5648 32.7162 18.1852 32.7162 17.9048 32.9199L16.3994 34.0137C15.7724 34.4692 14.9288 33.8563 15.1683 33.1192L15.7433 31.3495C15.8504 31.0199 15.7331 30.6588 15.4527 30.4551L13.9473 29.3613C13.3203 28.9058 13.6425 27.9141 14.4175 27.9141H16.2783C16.6249 27.9141 16.932 27.691 17.0391 27.3613L17.6142 25.5916Z" fill="#FFA800"/></svg>'

var buttonWrapper = document.createElement("div");
buttonWrapper.innerHTML = svgString.trim();

var newBtn = document.createElement("button");
newBtn.className = "ytp-fullscreen-button ytp-button";
newBtn.title = "collect";
newBtn.append(buttonWrapper.firstChild);
console.log('button created')
newBtn.onclick = function() {
    performBookmarkIconClickAction();
};

function performBookmarkIconClickAction() {
    document.getElementsByClassName("video-stream")[0].pause();
    console.log(document.getElementsByClassName("video-stream")[0].currentTime);
}